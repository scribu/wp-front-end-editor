#!/bin/bash

mkdir build 2> /dev/null

mkdir -p css
./lib/less/plessc less/core.less css/editor.css
sqwish css/editor.css -o build/editor.css > /dev/null

# main editor code
cd 'coffee'
cat core.coffee hover.coffee init.coffee fields/*.coffee | coffee -cs > '../build/editor.js'

# aloha plugins
cd ..
for plugin in 'wpImage'; do
	./bin/build-aloha $plugin
done

cd build
uglifyjs 'editor.js' > 'editor.min.js'
